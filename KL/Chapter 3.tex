\chapter{Path-Dependent Claims: Projection and Fast Pricing}

The pricing of exotic 
options remains a difficult task in quantitative finance. The main challenge is to find an adequate trade-off between pricing accuracy and fast computation. Efficient techniques such as finite difference \cite{Schwartz} or the fast Fourier transform \cite{Carr} are in general not applicable to path-dependent payoffs. Practitioners are often forced to turn to  standard Monte Carlo methods, despite being  slow. 
Therefore, researchers have come up with novel ideas over the years to tackle this issue.   
Recently, \citet{Hull} have employed deep learning to price vanilla and exotic options in a non-parametric manner while \citet{Szpruch,LyonsNum}
showed the benefits of the path signature  to project exotic payoffs in a nonlinear way. 

In this chapter, we move away from  prevailing machine learning methods and bring a classical tool  back into play: the Karhunen-Loève (KL) expansion \cite{Karhunen, Loeve}. The latter provides an  orthogonal decomposition of stochastic processes that is optimal in the $L^2(\Q \otimes dt)$ sense. %Many applications have been promising to approximate Gaussian process 
The theory has been widely applied to Gaussian processes \cite{Ghanem,Solin}  and  recently for the Brownian Bridge in a weighted Hilbert space \cite{Foster}. 
In this paper, the KL expansion takes on a newfound importance when it is applied to the projection of path functionals. We propose a simple simulation-based procedure, which we call the Karhunen-Loève Monte Carlo (KLMC) algorithm, to  compute the price  of exotic options.\footnote{See \href{https://github.com/valentintissot/KLMC.git}{https://github.com/valentintissot/KLMC} for an implementation.}
The superiority of KL-based Monte Carlo methods compared to the ordinary one was shown numerically in \cite{Acworth} for  the Brownian case. Our goal is here to further support these findings and 
extend this approach. We also discuss alternative methods employing the path signature as basis of the space of functionals. 

% and apply the KL expansion on the functional directly. 
%with few random variates per simulated path. 

%we propose a fast and  efficient procedure, called  Karhunen-Loève Monte Carlo (KLMC) algorithm computation of the price surface of path-dependent options. 


%We show how the KL expansion allows fast simulations of the transformed path through the functional and in turn efficient computation of  exotic option prices. 

The remainder of this chapter is structured as follows. In \Cref{sec:pathApprox}, we gather standard results from approximation theory and draw a %new 
parallel between Hilbert projection and the à la mode path signature. 
\Cref{sec:funcApprox} is devoted to the approximation of functionals, where two routes are contrasted as well as a short discussion on the use of the signature for this task. %as basis in the space of functionals.
We  apply the developed tools and finally present the KLMC algorithm with accompanying numerical evidence in \Cref{sec:application}.

\section{Notations}

For fixed horizon $T>0$, let $\Lambda_t = \calC([0,t],\R)$ and $\Lambda := \bigcup_{t\in[0,T]}\Lambda_t$.   For $X \in \Lambda_t$ and $s \le t$, $X_s$ denotes the  trajectory up to time $s$, while $x_s= X(s)$ is the value at time $s$. 
We equip $\Lambda$ with a $\sigma-$algebra $\calF$, filtration $\F$ and probability measure $\Q$ to form a stochastic basis $(\Lambda,\calF,\F, \Q)$. 

%The collection  $\Lambda$
%is used  to introduce \textit{running functionals} $f:\Lambda \to \R$  that map paths of different lengths.
The goal of this paper is to price exotic options with payoff of the form $\varphi = h\circ f$, where  $f:\Lambda \to \R$ is a  \textit{functional} and  $h$ a real function. 
 For instance, an Asian call option is obtained with $f(X_t) = \frac{1}{t}\int_{0}^t x_s ds$ and $h(y) = (y-K)^+$. If $\Q$ is a risk-neutral measure and assuming zero interest rate, then 
 $$p = \E^{\Q}[\varphi(X_\tau)],$$ is the value of the  option with payoff $\varphi$ and maturity $\tau \in [0,T]$.  
To compute $p$ using Monte Carlo, we  typically simulate an approximated version of $X \in \Lambda_\tau$, e.g. using time discretization. Alternatively, we can approximate the  \textit{transformed path},
$$Y = f(X), \quad y_t = f(X_t), \quad  t\in [0,\tau],$$ and  write $p = \E^{\Q}[h(y_\tau)]$. We favor the second option, as shown throughout the paper and in the numerical experiments. 

\input{KL/Path_Approx/PathApproxMain}
\input{KL/Functional_Approx/Funct_Approx_Main}

\input{KL/Applications/Applications}
\input{KL/Conclusion}

%\bibliography{KL/ref.bib}
